Downloading: "https://github.com/lukemelas/EfficientNet-PyTorch/releases/download/1.0/efficientnet-b4-6ed6700e.pth" to /root/.cache/torch/hub/checkpoints/efficientnet-b4-6ed6700e.pth
100.0%
Loaded pretrained weights for efficientnet-b4
/root/train.py:124: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/root/train.py:136: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: TrainLoss=0.7211 ValLoss=0.1986 ValAcc=0.9411
Epoch 2: TrainLoss=0.1521 ValLoss=0.0824 ValAcc=0.9721
Epoch 3: TrainLoss=0.0625 ValLoss=0.1293 ValAcc=0.9664
Epoch 4: TrainLoss=0.0580 ValLoss=0.1133 ValAcc=0.9721
Epoch 5: TrainLoss=0.0558 ValLoss=0.0572 ValAcc=0.9861
Epoch 6: TrainLoss=0.0337 ValLoss=0.1415 ValAcc=0.9690
Epoch 7: TrainLoss=0.0527 ValLoss=0.1153 ValAcc=0.9715
Epoch 8: TrainLoss=0.0227 ValLoss=0.1356 ValAcc=0.9664
Epoch 9: TrainLoss=0.0311 ValLoss=0.0715 ValAcc=0.9810
Epoch 10: TrainLoss=0.0475 ValLoss=0.0715 ValAcc=0.9823
Epoch 11: TrainLoss=0.0072 ValLoss=0.0714 ValAcc=0.9797
Epoch 12: TrainLoss=0.0233 ValLoss=0.0956 ValAcc=0.9721
EfficientNet-B4 training complete.
Using device: cuda
Downloading: "https://github.com/lukemelas/EfficientNet-PyTorch/releases/download/1.0/efficientnet-b4-6ed6700e.pth" to /root/.cache/torch/hub/checkpoints/efficientnet-b4-6ed6700e.pth
99.1%99.3%99.5%99.6%99.8%100.0%100.0%.4%36.3%36.5%
Loaded pretrained weights for efficientnet-b4
Model loaded from /vol/checkpoints_efficientnet/latest.pt
Processed 100 images...
Processed 200 images...
Processed 300 images...
Processed 400 images...
Processed 500 images...
Processed 600 images...
Processed 700 images...
Processed 800 images...
Processed 900 images...
Processed 1000 images...
Processed 1100 images...
Processed 1200 images...
Error processing 21151445fd63ff79440449974f17109d.jpg: cannot identify image file '/vol/evaluation_data/21151445fd63ff79440449974f17109d.jpg'
Processed 1300 images...
Processed 1400 images...
Processed 1500 images...
Processed 1600 images...
Error processing 2c18ee0e7cea8354149df435532d74ae.jpeg: cannot identify image file '/vol/evaluation_data/2c18ee0e7cea8354149df435532d74ae.jpeg'
Processed 1700 images...
Processed 1800 images...
Processed 1900 images...
Processed 2000 images...
Processed 2100 images...
Error processing 3a816aa78f56749a0822d700ff560924.jpeg: cannot identify image file '/vol/evaluation_data/3a816aa78f56749a0822d700ff560924.jpeg'
Processed 2200 images...
Processed 2300 images...
Processed 2400 images...
Processed 2500 images...
Processed 2600 images...
Processed 2700 images...
Processed 2800 images...
Error processing 4abc1b5dcf1be1de6503dc072e132fa0.jpeg: cannot identify image file '/vol/evaluation_data/4abc1b5dcf1be1de6503dc072e132fa0.jpeg'
Processed 2900 images...
Processed 3000 images...
Processed 3100 images...
Processed 3200 images...
Processed 3300 images...
Processed 3400 images...
Processed 3500 images...
Processed 3600 images...
Processed 3700 images...
Processed 3800 images...
Processed 3900 images...
Processed 4000 images...
Processed 4100 images...
Processed 4200 images...
Error processing 70ebf0bec317006017a54d6c9172af45.jpeg: cannot identify image file '/vol/evaluation_data/70ebf0bec317006017a54d6c9172af45.jpeg'
Processed 4300 images...
Processed 4400 images...
Processed 4500 images...
Processed 4600 images...
Processed 4700 images...
Processed 4800 images...
Processed 4900 images...
Processed 5000 images...
Processed 5100 images...
Processed 5200 images...
Processed 5300 images...
Processed 5400 images...
Error processing 8eeee227b3f244e980b747387bc79bf2.jpeg: cannot identify image file '/vol/evaluation_data/8eeee227b3f244e980b747387bc79bf2.jpeg'
Processed 5500 images...
Processed 5600 images...
Processed 5700 images...
Processed 5800 images...
Processed 5900 images...
Processed 6000 images...
Error processing 9e748b9617e26b90011f8d7c3f8a7eee.jpeg: cannot identify image file '/vol/evaluation_data/9e748b9617e26b90011f8d7c3f8a7eee.jpeg'
Processed 6100 images...
Error processing a008f795ae8498751f2e5feeb0b73387.jpeg: cannot identify image file '/vol/evaluation_data/a008f795ae8498751f2e5feeb0b73387.jpeg'
Processed 6200 images...
Processed 6300 images...
Processed 6400 images...
Processed 6500 images...
Processed 6600 images...
Processed 6700 images...
Processed 6800 images...
Processed 6900 images...
Processed 7000 images...
Processed 7100 images...
Processed 7200 images...
Processed 7300 images...
Processed 7400 images...
Processed 7500 images...
Processed 7600 images...
Processed 7700 images...
Processed 7800 images...
Error processing ce2388179ec73203a60d8efedd04e0f1.jpeg: cannot identify image file '/vol/evaluation_data/ce2388179ec73203a60d8efedd04e0f1.jpeg'
Processed 7900 images...
Processed 8000 images...
Processed 8100 images...
Error processing d4b080c6ce4933f1199fad7f75e7d112.jpeg: cannot identify image file '/vol/evaluation_data/d4b080c6ce4933f1199fad7f75e7d112.jpeg'
Processed 8200 images...
Processed 8300 images...
Processed 8400 images...
Processed 8500 images...
Processed 8600 images...
Error processing e21dcb1cb0571a21a013b4232d1b6a13.jpeg: cannot identify image file '/vol/evaluation_data/e21dcb1cb0571a21a013b4232d1b6a13.jpeg'
Processed 8700 images...
Processed 8800 images...
Processed 8900 images...
Processed 9000 images...
Processed 9100 images...
Processed 9200 images...
Processed 9300 images...
Processed 9400 images...
Error processing f7679411e290bfd8dc90b3eadb57460a.jpeg: cannot identify image file '/vol/evaluation_data/f7679411e290bfd8dc90b3eadb57460a.jpeg'
Processed 9500 images...
Processed 9600 images...
Processed 9700 images...
Error processing ffd4f9df7163f55474a0182265c8d810.jpeg: cannot identify image file '/vol/evaluation_data/ffd4f9df7163f55474a0182265c8d810.jpeg'
Total images processed: 9745
Predictions saved to /vol/efficientnet_b4_predictions.csv                                                                                  
Sample predictions (first 10):
  000300afd862e8092248f343a27cdd75.jpg: 9
  0003f95fe5b6aea891f325385aa6032b  -.jpg: 4
  000c8e493b76d0b8728154b0acc4fa7e.jpg: 4
  000caf706334cf9598988fbf3e103a0c  -.jpg: 9
  00165d6f69c3be0eeb5d6d25c178daae  -.png: 7
  002e536c6ed02b24842c2e10ee9bb01a.JPG: 4
  00346dc2ee5bbff37668854ab2a18b57.png: 3
  003f925de895162d8076c9d85a53738d.png: 0
  0046d4f9232ff35acf873edaff070522  -.png: 4
  0048829b4a23851b4a6ccd0d7f71d323.png: 6